<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:models="clr-namespace:IT_Assets.Models"
             x:Class="IT_Assets.Pages.MaintenancePage"
             Title="Maintenance"
             BackgroundColor="#F4F6FA">

    <ScrollView>
        <VerticalStackLayout Padding="15">
            <HorizontalStackLayout  Padding="20" Spacing="470">
                <!-- Back button-->
                <Button Text="Back" 
                     BackgroundColor="#0099CC" 
                     FontSize="15"
                     TextColor="White" 
                     CornerRadius="12" 
                     HeightRequest="20"
                     Clicked="OnCancelClicked"
                     WidthRequest="80"
                     VerticalOptions="Center"/>

                <Label Text="Maintenance Schedule"
                    FontSize="24"
                    FontAttributes="Bold"
                    TextColor="#333"
                    Margin="0,10,0,20"
                    HorizontalOptions="Center"/>

            </HorizontalStackLayout>
           

            <Grid ColumnDefinitions="0.6*,0.7*,0.8*,0.9*,0.9*,auto"
                 BackgroundColor="Gray"
                 Padding="10">
                <Label Text="Code" TextColor="White" FontAttributes="Bold" />
                <Label Text="Name" Grid.Column="1" TextColor="White" FontAttributes="Bold" />
                <Label Text="Model" Grid.Column="2" TextColor="White" FontAttributes="Bold" />
                <Label Text="Location" Grid.Column="3" TextColor="White" FontAttributes="Bold" />
                <Label Text="Receipt Form" Grid.Column="4" TextColor="White" FontAttributes="Bold" />
                <Label Text="Maintainance date" Grid.Column="5" TextColor="White" FontAttributes="Bold" />
            </Grid>
            
            <BoxView HeightRequest="2" Color="#D0D7E2" />
            
            <CollectionView x:Name="MaintenanceCollectionView"
                            SelectionMode="None"
                            ItemsSource="{Binding MaintenanceAssets}">
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="models:AssetModel">
                        <Frame CornerRadius="15"
                               BorderColor="#E0E3E8"
                               BackgroundColor="White"
                               Margin="5"
                               Padding="12"
                               HasShadow="True">
                            <Grid ColumnDefinitions="0.6*,0.7*,0.7*,0.9*,0.9*,auto">
                                <Label Grid.Column="0"
                                       Text="{Binding Code}"
                                       FontAttributes="Bold"
                                       FontSize="15"
                                       TextColor="#333"/>

                                <Label Grid.Column="1"
                                       Text="{Binding Name}"
                                       FontSize="15"
                                       TextColor="#333"/>

                                <Label Grid.Column="2"
                                       Text="{Binding Model}"
                                       FontSize="15"
                                       TextColor="#333"/>

                                <!-- Actual last maintenance -->
                                <Label Grid.Column="3"
                                       Text="{Binding MaintenanceDate, StringFormat='{0:yyyy-MM-dd}'}"
                                       FontSize="15"
                                       TextColor="#555"/>

                                <!-- Computed required maintenance -->
                                <Label Grid.Column="4"
                                       Text="{Binding RequiredMaintenanceDate, StringFormat='{0:yyyy-MM-dd}'}"
                                       FontSize="15"
                                       TextColor="#E53935"
                                       FontAttributes="Bold"/>

                                <Button Grid.Column="5"
                                        Text="Maintained"
                                        BackgroundColor="#4CAF50"
                                        TextColor="White"
                                        CornerRadius="8"
                                        Padding="10,5"
                                        Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.MaintainCommand}"
                                        CommandParameter="{Binding .}" />
                            </Grid>
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
